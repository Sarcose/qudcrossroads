<?xml version="1.0" encoding="utf-8"?>
<conversations Namespace="Hearthpyre.Dialogue">

  <!-- Merge invite & manage routes to base conversation -->
  <conversation ID="BaseConversation" Namespace="Settler">
    <!-- Start choices -->
    <choice ID="HearthpyreInviteChoice" Target="HearthpyreInvite" Transient="true">
      <part Name="Invite" Target="HearthpyreInviteReject" />
      <text Priority="-1">Would you join me in my settlement, =pronouns.siblingTerm=?</text>
      <text IfHavePart="SociallyRepugnant">
        You. My place. Come.~
        This place sucks, =pronouns.personTerm=. Follow me. I will show you how to live.~
        How do you live like this? My settlement is much better.~
        I know somewhere better than this hole. Join me.
      </text>
    </choice>
    <choice ID="HearthpyreManageChoice" Target="HearthpyreManage" IfSpeakerHavePart="HearthpyreSettler" Transient="true">
      <text Priority="-1">A moment of your time, =pronouns.siblingTerm=?</text>
      <text IfHavePart="SociallyRepugnant">
        Listen to me.~
        {{emote|*points rudely*}} You. Listen.~
        I have orders for you.~
        You are not doing anything important, yes?
      </text>
      <part Name="Tag">{{g|[manage]}}</part>
    </choice>

    <!-- Nodes -->
    <node ID="HearthpyreInvite">
      <text Priority="-1">{{emote|*tilts =pronouns.possessive= =bodypart:Head= quizzically*}}</text>
      <part Name="Translate" Adjective="Inquisitive">
        <text ID="Animals" Type="Script">{{emote|*inquisitive gnarl*}}</text>
        <text ID="Insects" Type="Script">
          {{emote|*perplexed clicking*}}~
          {{emote|*curious buzzing*}}
        </text>
        <text ID="Crabs" Type="Script">{{emote|*puzzled rasping*}}</text>
        <text ID="Oozes" Type="Script">{{emote|*inquisitive gushing*}}</text>
        <text ID="Reptiles" Type="Script">{{emote|*snoopy hiss*}}</text>
        <text ID="Spiders" Type="Script">{{emote|*weaves a web of queries*}}</text>
        <text ID="Issachari" Type="Script">
          Where is your salt-bereft hovel?~
          I'm listening. Where?
        </text>
        <text ID="Humanoid" Type="Property">
          Where would you have me go?~
          Where is this settlement of yours?
        </text>
        <text ID="Snapjaw" Type="Species">
          gnrrr.. where far go me?~
          ooooh where!
        </text>
        <text ID="Hindren" Type="Species">
          Where do kendren live?~
          I am curious, where would a kendren call home?
        </text>
        <text ID="Cat" Type="Species">
          {{emote|*meow*}}~
          {{emote|*analytical mew*}}
        </text>
      </part>
      <part Name="PopulateSettlements">
        <choice Target="HearthpyreInviteAccept">
          <part Name="SelectSettlement" />
          <text>=settlement.name=. =settlement.directions=.</text>
        </choice>
      </part>
      <choice Target="Start" Ordinal="999999">
        <text>My apologies, I've changed my mind.</text>
        <text>Hmm. I shall have to think on it further.</text>
      </choice>
    </node>
    <node ID="HearthpyreInviteAccept">
      <text Priority="-1">{{emote|*nods mutely*}}</text>
      <part Name="Translate" Adjective="Affirmative">
        <text ID="Animals" Type="Script">{{emote|*affirming gurl*}}</text>
        <text ID="Robots" Type="Script">{{G|*boop boop*}}</text>
        <text ID="Issachari" Type="Script">
          No promises, lack-salt.~
          Don't worry lack-salt, my expectations are low.
        </text>
        <text ID="Humanoid" Type="Property">
          I accept your hospitality, =player.formalAddressTerm=.~
          It would be my pleasure, =player.formalAddressTerm=.
        </text>
        <text ID="Snapjaw" Type="Species">
          gogogo! livendrink! go!~
          ekekeke!~
          grn. there food? warm? eheheh.
        </text>
      </part>
      <choice Target="End">Welcome, =pronouns.siblingTerm=.</choice>
    </node>
    <node ID="HearthpyreInviteReject">
      <text Priority="-1">{{emote|*shakes =pronouns.possessive= =bodypart:Head= in refusal*}}</text>
      <part Name="Translate" Adjective="Dissenting">
        <text ID="Animals" Type="Script">{{emote|*disinterested yawn*}}</text>
        <text ID="Robots" Type="Script">{{R|*BEEP BEEP BEEP*}}</text>
        <text ID="Issachari" Type="Script">
          No, keep moving lack-salt.~
          Don't test me, lack-salt.~
          I'd rather dig a hole in the salt and live there.~
          Saltbacks have expressed more tempting offers with their refuse. No.
        </text>
        <text ID="Humanoid" Type="Property">
          I'm otherwise committed, I apologize.~
          I have to decline unfortunately.~
          Hmm. I'd rather not.
        </text>
        <text ID="Snapjaw" Type="Species">
          {{emote|*snarls*}}~
          hah! gnnnah... no.~
          leave. bite you!
        </text>
      </part>
      <choice ID="BeguileChoice"  Target="HearthpyreInvite" Transient="true">
        <part Name="InviteBeguile" />
        <part Name="TextFragments" />
        <text>Please? {{emote|*strikes a plucky pose*}} For me?</text>
        <text>Oh, but I insist. I would appreciate the company of a =fragment.person= who also venerates =fragment.sacred=.</text>
        <text>Must it be so? Long have I admired your =fragment.poetic= from afar, are our threads never to entwine?</text>
      </choice>
      <choice ID="ProselytizeChoice" Target="HearthpyreInvite" Transient="true">
        <part Name="InviteProselytize" />
        <part Name="TextFragments" />
        <text>I understand your qualms, especially for a grand =fragment.person= like yourself it will seem a risky venture. I assure you, the accomodations for =fragment.activity= will be... opulent.</text>
        <text>Are you certain? It's a very scenic location with great access for =fragment.village=.</text>
        <text>Of course, you wouldn't be interested in beautiful vistas, =fragment.arable=, and =fragment.sacred=. It was a foolish notion.</text>
      </choice>
      <choice Target="End">
        <text>Perhaps another time. Live and drink.</text>
        <text>I see. Live and drink.</text>
        <text>Fine. Live and drink.</text>
        <text IfHavePart="SociallyRepugnant">You haven't seen the last of me.</text>
      </choice>
    </node>

    <node ID="HearthpyreManage">
      <text Priority="-1">{{emote|*nods =pronouns.possessive= =bodypart:Head=*}}</text>
      <part Name="Translate">
        <text ID="Animals" Type="Script">{{emote|*stare*}}</text>
        <text ID="Robots" Type="Script">{{emote|*boop*}}</text>
        <text ID="Issachari" Type="Script">
          Speak.~
          I'm listening.
        </text>
        <text ID="Humanoid" Type="Property">
          Of course, what is it =player.formalAddressTerm=?~
          Yes? Do you need something?~
          What do you need, =player.formalAddressTerm=?
        </text>
        <text ID="Snapjaw" Type="Species">
          geheh. what.~
          hohohoho.~
          =player.siblingTerm=... uhuhu!
        </text>
      </part>
      <choice ID="FollowChoice" Target="HearthpyreGenericAssent">
        <text>Follow me for a moment, if you will.</text>
        <text>Come, I have something to show you.</text>
        <part Name="Follow" />
      </choice>
      <choice ID="MoveChoice" Target="HearthpyreInvite" IfHaveSettlements="2">
        <text>I have another settlement that you're welcome to join.</text>
        <text>Should you wish it, there is another settlement that will have you.</text>
      </choice>
      <choice ID="StayHomeChoice" Target="HearthpyreGenericAssent">
        <text Priority="1">
          I need to find you quickly, =pronouns.formalAddressTerm=.
          Could we meet in your home when I am here?
        </text>
        <text ID="Retract">You no longer need to wait for me at home.</text>
        <part Name="StayHome" />
      </choice>
      <choice ID="MerchantChoice" Target="HearthpyreGenericGratitude">
        <text>I appoint you merchant of this settlement.</text>
        <part Name="Appoint" Retainer="Merchant" Stock="HearthpyreMerchant_1" Token="Merchant's Token" />
      </choice>
      <choice ID="WardenChoice" Target="HearthpyreGenericGratitude">
        <text>I appoint you warden of this settlement.</text>
        <part Name="Appoint" Retainer="Warden" Token="HearthpyreTokenWarden" />
      </choice>
      <choice ID="TinkerChoice" Target="HearthpyreGenericGratitude">
        <text>I appoint you tinker of this settlement.</text>
        <part Name="Appoint" Retainer="Tinker" Stock="Village Tinker 1" Token="HearthpyreTokenTinker" />
      </choice>
      <choice ID="MinstrelChoice" Target="HearthpyreGenericGratitude">
        <text>I appoint you minstrel of this settlement.</text>
        <part Name="Appoint" Retainer="Minstrel" Stock="BookBinderInventory" Token="Minstrel's Token" />
      </choice>
      <choice ID="ApothecaryChoice" Target="HearthpyreGenericGratitude">
        <text>I appoint you apothecary of this settlement.</text>
        <part Name="Appoint" Retainer="Apothecary" Stock="Village Apothecary 1" Token="Farmers Token" />
      </choice>
      <choice Target="End">
        <text>It was nothing, carry on.</text>
        <text>Carry on, =pronouns.formalAddressTerm=.</text>
      </choice>
    </node>

    <node ID="HearthpyreGenericGratitude">
      <text Priority="-1">
        {{emote|*beams with gratitude*}}~
        {{emote|*hugs you with =pronouns.possessive= =bodypart:Hands=*}}
      </text>
      <part Name="Translate">
        <text ID="Animals" Type="Script">{{emote|*gleeful gnar*}}</text>
        <text ID="Crabs" Type="Script">{{emote|*clacks =pronouns.possessive= =bodypart:Hands:= together jovially*}}</text>
        <text ID="Robots" Type="Script">{{G|*beeeeeeep*}}</text>
        <text ID="Issachari" Type="Script">{{emote|*grins menacingly*}}</text>
        <text ID="Humanoid" Type="Property">
          Thank you!~
          I am grateful.
        </text>
        <text ID="Snapjaw" Type="Species">
          ooooooh... food?~
          {{emote|*=pronouns.possessive= ears perk up*}} what! me? what!!~
          you. heh! thank.
        </text>
      </part>
      <choice Target="End">Live and drink.</choice>
    </node>
    <node ID="HearthpyreGenericAssent">
      <text Priority="-1">
        {{emote|*shrugs lightly*}}~
        {{emote|*flashes the universal sign of approval with =pronouns.possessive= =bodypart:Hand=*}}
      </text>
      <part Name="Translate">
        <text ID="Animals" Type="Script">{{emote|*affirming gurl*}}</text>
        <text ID="Robots" Type="Script">{{emote|*beep beep*}}</text>
        <text ID="Issachari" Type="Script">
          This better be good.~
          Fine.
        </text>
        <text ID="Humanoid" Type="Property">
          Of course.~
          Very well.
        </text>
        <text ID="Snapjaw" Type="Species">
          hrn?~
          yehehe!~
          keh! gnah!
        </text>
      </part>
      <choice Target="End">Live and drink.</choice>
    </node>
  </conversation>

  <!-- Snappy friend with a xyloschemer -->
  <conversation ID="SnapjawXylogrifter" Namespace="Xylogrifter">
    <part Name="PredicateWornOn" Register="All" />
    <start ID="Framds">
      <text>
        ekehe... friemd?~
        framd bonk?~
        {{emote|*sniff sniff*}} hoho. no.~
        yi yi?~
        hrf. mvn. nnnnn...~
        wwohhhrrr.~
        hihi. talk? ehe.
      </text>
      <choice Target="SchemerBroken" IfSpeakerHaveProperty="SchemerBroken">You gave me a broken wand.</choice>
      <choice Target="WhatHolding" IfSpeakerWearingBlueprint="HearthpyreXyloschemer">What is that you're holding?</choice>
      <choice Target="WhatDoing" IfSpeakerNotHaveProperty="TurnsAsPlayerMinion">How did you come to be here?</choice>
      <choice Target="End">Live and drink.</choice>
    </start>
    <start ID="Party" IfLedBy="Player" Priority="1" Inherits="Framds">
      <text>
        hrf. where far go we?~
        bonk! us! bonk! deh heh.~
        ye. heh! stopps??~
        here. mnf. strange.~
        eeehh. hm. gnf.~
        {{emote|*tilts =pronouns.possessive= =bodypart:Head= quizzically*}} yi?~
        mh! =name=. hohohohoho.
      </text>
      <choice Target="HowDoing">How fare you, =subject.name=?</choice>
    </start>
    <!-- Ask what they're up to, if they're visiting or exploring -->
    <node ID="WhatDoing">
      <text IfSpeakerHaveProperty="Visiting">
        here fremds! hnf.~
        yeh. ehe. food!~
        gn? dink? {{paisley|wofaro}}.~
        oooh. smell good here. {{emote|*sniff*}} you?
      </text>
      <text IfSpeakerNotHaveProperty="Visiting">
        dunno.~
        is looking. au... not find.~
        mmmm... {{emote|*shrug*}}~
        same you. hee!
      </text>
      <choice Target="Start">
        <text IfSpeakerHaveProperty="Visiting">I see. Good luck, then.</text>
        <text Priority="-1">I see. Safe travels.</text>
      </choice>
    </node>
    <!-- Ask how they're doing, if they're in our party -->
    <node ID="HowDoing">
      <text>hn. vfff. goom!</text>
      <text>ruh? mmmmmm... eeeehhhhh... eat?</text>
      <text>do timk! ye.</text>
      <text>bem. bom. nom?</text>
      <text IfTime="1000-450">mmmmff... dark.</text>
      <choice Target="End">Let us move on.</choice>
    </node>
    <!-- Ask what they're holding, though the answer is not very elucidating -->
    <node ID="WhatHolding">
      <text>
        ky. kyyko.. emrrr? no. is no.~
        is blinkdink. yis.~
        ehhhh...? is {{psionic|haffyibonk}}!
      </text>
      <choice Target="TradeSchemer" IfSpeakerNotHaveProperty="SchemerTraded">Very nice! Do you want to trade for it?</choice>
      <choice Target="End">Interesting... live and drink.</choice>
    </node>
    <!-- Ask if they wish to trade, they might just give it to us -->
    <node ID="TradeSchemer" AllowEscape="false">
      <part Name="TradeSchemer" />
      <text Priority="-1">
        hn? is ok. {{emote|*=pronouns.Possessive= face splits into a wide grin*}}

        giv you. hehehe.
      </text>
      <text IfCommand="Feet">
        hrf. ng. =item.color= big stonp?

        {{emote|*=pronouns.Subjective= =verb:point:afterpronoun= at =pronouns.possessive= large furry paws*}}
      </text>
      <text IfCommand="Hands">
        hohoho. =item.color= grabtakes?

        ehg. ehhhh! {{emote|*=pronouns.Subjective= =verb:flail:afterpronoun= =pronouns.possessive= hands around wildly*}}
      </text>
      <text IfCommand="Arm">
        gnah? =item.color= hoop dink!

        {{emote|*=pronouns.Subjective= =verb:point:afterpronoun= at =pronouns.possessive= naked wrist*}}
      </text>
      <choice ID="PresentItem" Target="TradeComplete" IfSpeakerNotHaveProperty="SchemerTraded">
        <text>=objpronouns.IndicativeProximal= =object.single= perhaps?</text>
        <part Name="PresentItem" />
      </choice>
      <choice Inherits="PresentItem">Try =objpronouns.indicativeProximal= =object.single= on.</choice>
      <choice Inherits="PresentItem">=objpronouns.IndefiniteArticle==object.single= maybe?</choice>
      <choice Inherits="PresentItem">How about =objpronouns.indefiniteArticle==object.single=?</choice>
      <choice Target="End">
        <text Priority="-1">I will strive to find such an item. Live and drink.</text>
        <text IfSpeakerHaveProperty="SchemerTraded">Oh! You have my heartfelt thanks, snap=pronouns.formalAddressTerm=.</text>
      </choice>
    </node>
    <!-- Traded for xyloschemer with a cool thing (to snapjaws) -->
    <node ID="TradeComplete">
      <part Name="WearItem" Register="All" />
      <text Priority="-1">ohhhhhh... thamks!</text>
      <text IfCommand="Feet">
        geh eheheh heh!

        {{emote|*=pronouns.Subjective= =verb:scramble:afterpronoun= to slip =object.the==object.single= on =pronouns.possessive= padded feet*}}

        ohhhhhh... thamks!
      </text>
      <text IfCommand="Hands">
        ohoho hoh hee!

        {{emote|*=pronouns.Subjective= =verb:scramble:afterpronoun= to slip =object.the==object.single= on =pronouns.possessive= hands*}}

        look look!
      </text>
      <text IfCommand="Arm">
        mnnn! dohohohoho.

        {{emote|*=pronouns.Subjective= =verb:scramble:afterpronoun= to slip =object.the==object.single= on =pronouns.possessive= arm*}}

        ohhhhhh... thamks!
      </text>
      <choice Target="End">=objpronouns.Subjective= =objverb:suit:afterpronoun= you. Live and drink.</choice>
    </node>
    <!-- If the xyloschemer we were given was rusted or broken -->
    <node ID="SchemerBroken" SetSpeakerIntProperty="SchemerBroken">
      <text>
        {{emote|*=subject.T= =verb:shrug= slowly*}}

        hnnn... what broken not is.

        one bimdonp. good make can. yee?
      </text>
      <choice Target="End" IfNotLedBy="Player">
        <text>I am not of such patient disposition.</text>
        <part Name="StartFight" />
      </choice>
      <choice Target="End">Yes, I suppose. Live and bimp, =pronouns.formalAddressTerm=.</choice>
    </node>
  </conversation>

</conversations>